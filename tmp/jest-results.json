{"numFailedTestSuites":3,"numFailedTests":30,"numPassedTestSuites":15,"numPassedTests":121,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":18,"numTotalTests":151,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1763670143793,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":["High-Risk Audit Trail Integration","High-Risk Case Logging"],"duration":1510,"failureDetails":[],"failureMessages":[],"fullName":"High-Risk Audit Trail Integration High-Risk Case Logging should log high-risk case with ML fields when confidence > 0.8","invocations":1,"location":null,"numPassingAsserts":19,"retryReasons":[],"status":"passed","title":"should log high-risk case with ML fields when confidence > 0.8"},{"ancestorTitles":["High-Risk Audit Trail Integration","High-Risk Case Logging"],"duration":1504,"failureDetails":[],"failureMessages":[],"fullName":"High-Risk Audit Trail Integration High-Risk Case Logging should not log high-risk case when confidence <= 0.8","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should not log high-risk case when confidence <= 0.8"},{"ancestorTitles":["High-Risk Audit Trail Integration","High-Risk Case Logging"],"duration":1479,"failureDetails":[],"failureMessages":[],"fullName":"High-Risk Audit Trail Integration High-Risk Case Logging should handle missing ML fields with defaults","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"should handle missing ML fields with defaults"},{"ancestorTitles":["High-Risk Audit Trail Integration","Unknown-Risk Case Logging"],"duration":1491,"failureDetails":[],"failureMessages":[],"fullName":"High-Risk Audit Trail Integration Unknown-Risk Case Logging should log unknown-risk case with ML fields when confidence < 0.3","invocations":1,"location":null,"numPassingAsserts":19,"retryReasons":[],"status":"passed","title":"should log unknown-risk case with ML fields when confidence < 0.3"},{"ancestorTitles":["High-Risk Audit Trail Integration","Unknown-Risk Case Logging"],"duration":1477,"failureDetails":[],"failureMessages":[],"fullName":"High-Risk Audit Trail Integration Unknown-Risk Case Logging should not log unknown-risk case when confidence >= 0.3","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should not log unknown-risk case when confidence >= 0.3"},{"ancestorTitles":["High-Risk Audit Trail Integration","Unknown-Risk Case Logging"],"duration":1458,"failureDetails":[],"failureMessages":[],"fullName":"High-Risk Audit Trail Integration Unknown-Risk Case Logging should handle missing ML fields with defaults for unknown risk","invocations":1,"location":null,"numPassingAsserts":8,"retryReasons":[],"status":"passed","title":"should handle missing ML fields with defaults for unknown risk"},{"ancestorTitles":["High-Risk Audit Trail Integration","PII Redaction in Audit Trails"],"duration":1494,"failureDetails":[{"matcherResult":{"message":"expect(received).toHaveLength(expected)\n\nExpected length: 1\nReceived length: 3\nReceived array:  [{\"context\": {\"logger\": \"HighRiskLogger\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.9, \"detectionTimestamp\": \"2025-11-20T20:22:28.528Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670148529_amsa8jtk0\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:28.529Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": \"session-789\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:25.540Z\", \"featureVector\": {\"indicators\": [\"malicious\", \"suspicious\"]}, \"mitigationActions\": [\"block\", \"alert\"], \"riskCategory\": \"high\", \"threatPatternId\": \"pattern-001\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"sessionId\": \"session-789\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670145542_ctlhvrifj\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:25.542Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": undefined, \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"[EMAIL_REDACTED]\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.95, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:34.448Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"sessionId\": undefined, \"stage\": \"high_risk_detection\", \"userId\": \"user@example.com\"}, \"id\": \"audit_1763670154449_s0pts9w3y\", \"level\": \"info\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:34.449Z\"}]","pass":false}}],"failureMessages":["Error: expect(received).toHaveLength(expected)\n\nExpected length: 1\nReceived length: 3\nReceived array:  [{\"context\": {\"logger\": \"HighRiskLogger\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.9, \"detectionTimestamp\": \"2025-11-20T20:22:28.528Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670148529_amsa8jtk0\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:28.529Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": \"session-789\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:25.540Z\", \"featureVector\": {\"indicators\": [\"malicious\", \"suspicious\"]}, \"mitigationActions\": [\"block\", \"alert\"], \"riskCategory\": \"high\", \"threatPatternId\": \"pattern-001\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"sessionId\": \"session-789\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670145542_ctlhvrifj\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:25.542Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": undefined, \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"[EMAIL_REDACTED]\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.95, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:34.448Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"sessionId\": undefined, \"stage\": \"high_risk_detection\", \"userId\": \"user@example.com\"}, \"id\": \"audit_1763670154449_s0pts9w3y\", \"level\": \"info\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:34.449Z\"}]\n    at Object.toHaveLength (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/high-risk-audit-trail.test.js:212:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"High-Risk Audit Trail Integration PII Redaction in Audit Trails should redact PII in high-risk case metadata","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should redact PII in high-risk case metadata"},{"ancestorTitles":["High-Risk Audit Trail Integration","PII Redaction in Audit Trails"],"duration":1486,"failureDetails":[{"matcherResult":{"message":"expect(received).toHaveLength(expected)\n\nExpected length: 1\nReceived length: 3\nReceived array:  [{\"context\": {\"logger\": \"UnknownRiskLogger\", \"severity\": \"info\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.1, \"detectionTimestamp\": \"2025-11-20T20:22:32.955Z\", \"featureVector\": {\"riskIndicators\": [\"unclear_threat\"]}, \"mitigationActions\": [\"hitl_required\"], \"riskCategory\": \"unknown\", \"threatPatternId\": \"unknown_pattern\", \"trainingLabels\": {\"supervised\": \"unknown_risk\"}}, \"resourceId\": \"resource-789\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"id\": \"audit_1763670152956_pqhsiatx7\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"unknown_risk_case\", \"timestamp\": \"2025-11-20T20:22:32.956Z\"}, {\"context\": {\"logger\": \"UnknownRiskLogger\", \"sessionId\": \"session-101\", \"severity\": \"info\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.8, \"confidenceScore\": 0.2, \"detectionTimestamp\": \"2025-11-20T20:22:30.018Z\", \"featureVector\": {\"indicators\": [\"unclear\"]}, \"mitigationActions\": [\"review\"], \"riskCategory\": \"unknown\", \"threatPatternId\": \"unknown-001\", \"trainingLabels\": {\"supervised\": \"unknown_risk\"}}, \"resourceId\": \"resource-789\", \"sessionId\": \"session-101\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"id\": \"audit_1763670150019_ixhbdhv39\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"unknown_risk_case\", \"timestamp\": \"2025-11-20T20:22:30.019Z\"}, {\"context\": {\"logger\": \"UnknownRiskLogger\", \"sessionId\": undefined, \"severity\": \"info\", \"stage\": \"unknown_risk_detection\", \"userId\": \"[EMAIL_REDACTED]\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.1, \"detectionTimestamp\": \"2025-11-20T20:22:35.942Z\", \"featureVector\": {\"riskIndicators\": [\"unclear_threat\"]}, \"mitigationActions\": [\"hitl_required\"], \"riskCategory\": \"unknown\", \"threatPatternId\": \"unknown_pattern\", \"trainingLabels\": {\"supervised\": \"unknown_risk\"}}, \"resourceId\": \"resource-789\", \"sessionId\": undefined, \"stage\": \"unknown_risk_detection\", \"userId\": \"user@example.com\"}, \"id\": \"audit_1763670155942_tqqncvieg\", \"level\": \"info\", \"operation\": \"unknown_risk_case\", \"timestamp\": \"2025-11-20T20:22:35.942Z\"}]","pass":false}}],"failureMessages":["Error: expect(received).toHaveLength(expected)\n\nExpected length: 1\nReceived length: 3\nReceived array:  [{\"context\": {\"logger\": \"UnknownRiskLogger\", \"severity\": \"info\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.1, \"detectionTimestamp\": \"2025-11-20T20:22:32.955Z\", \"featureVector\": {\"riskIndicators\": [\"unclear_threat\"]}, \"mitigationActions\": [\"hitl_required\"], \"riskCategory\": \"unknown\", \"threatPatternId\": \"unknown_pattern\", \"trainingLabels\": {\"supervised\": \"unknown_risk\"}}, \"resourceId\": \"resource-789\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"id\": \"audit_1763670152956_pqhsiatx7\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"unknown_risk_case\", \"timestamp\": \"2025-11-20T20:22:32.956Z\"}, {\"context\": {\"logger\": \"UnknownRiskLogger\", \"sessionId\": \"session-101\", \"severity\": \"info\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.8, \"confidenceScore\": 0.2, \"detectionTimestamp\": \"2025-11-20T20:22:30.018Z\", \"featureVector\": {\"indicators\": [\"unclear\"]}, \"mitigationActions\": [\"review\"], \"riskCategory\": \"unknown\", \"threatPatternId\": \"unknown-001\", \"trainingLabels\": {\"supervised\": \"unknown_risk\"}}, \"resourceId\": \"resource-789\", \"sessionId\": \"session-101\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"id\": \"audit_1763670150019_ixhbdhv39\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"unknown_risk_case\", \"timestamp\": \"2025-11-20T20:22:30.019Z\"}, {\"context\": {\"logger\": \"UnknownRiskLogger\", \"sessionId\": undefined, \"severity\": \"info\", \"stage\": \"unknown_risk_detection\", \"userId\": \"[EMAIL_REDACTED]\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.1, \"detectionTimestamp\": \"2025-11-20T20:22:35.942Z\", \"featureVector\": {\"riskIndicators\": [\"unclear_threat\"]}, \"mitigationActions\": [\"hitl_required\"], \"riskCategory\": \"unknown\", \"threatPatternId\": \"unknown_pattern\", \"trainingLabels\": {\"supervised\": \"unknown_risk\"}}, \"resourceId\": \"resource-789\", \"sessionId\": undefined, \"stage\": \"unknown_risk_detection\", \"userId\": \"user@example.com\"}, \"id\": \"audit_1763670155942_tqqncvieg\", \"level\": \"info\", \"operation\": \"unknown_risk_case\", \"timestamp\": \"2025-11-20T20:22:35.942Z\"}]\n    at Object.toHaveLength (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/high-risk-audit-trail.test.js:231:34)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"High-Risk Audit Trail Integration PII Redaction in Audit Trails should redact PII in unknown-risk case metadata","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should redact PII in unknown-risk case metadata"},{"ancestorTitles":["High-Risk Audit Trail Integration","Concurrent High-Risk Detections"],"duration":1506,"failureDetails":[{"matcherResult":{"message":"expect(received).toHaveLength(expected)\n\nExpected length: 2\nReceived length: 4\nReceived array:  [{\"context\": {\"logger\": \"HighRiskLogger\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.9, \"detectionTimestamp\": \"2025-11-20T20:22:28.528Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670148529_amsa8jtk0\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:28.529Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": \"session-789\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:25.540Z\", \"featureVector\": {\"indicators\": [\"malicious\", \"suspicious\"]}, \"mitigationActions\": [\"block\", \"alert\"], \"riskCategory\": \"high\", \"threatPatternId\": \"pattern-001\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"sessionId\": \"session-789\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670145542_ctlhvrifj\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:25.542Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": undefined, \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"user1\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.95, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:37.444Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"res1\", \"sessionId\": undefined, \"stage\": \"high_risk_detection\", \"userId\": \"user1\"}, \"id\": \"audit_1763670157445_yp1b2bi2g\", \"level\": \"info\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:37.445Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": undefined, \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"user2\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.9, \"detectionTimestamp\": \"2025-11-20T20:22:37.448Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"res2\", \"sessionId\": undefined, \"stage\": \"high_risk_detection\", \"userId\": \"user2\"}, \"id\": \"audit_1763670157449_oxaqntgik\", \"level\": \"info\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:37.449Z\"}]","pass":false}}],"failureMessages":["Error: expect(received).toHaveLength(expected)\n\nExpected length: 2\nReceived length: 4\nReceived array:  [{\"context\": {\"logger\": \"HighRiskLogger\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.9, \"detectionTimestamp\": \"2025-11-20T20:22:28.528Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670148529_amsa8jtk0\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:28.529Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": \"session-789\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:25.540Z\", \"featureVector\": {\"indicators\": [\"malicious\", \"suspicious\"]}, \"mitigationActions\": [\"block\", \"alert\"], \"riskCategory\": \"high\", \"threatPatternId\": \"pattern-001\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"sessionId\": \"session-789\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670145542_ctlhvrifj\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:25.542Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": undefined, \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"user1\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.95, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:37.444Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"res1\", \"sessionId\": undefined, \"stage\": \"high_risk_detection\", \"userId\": \"user1\"}, \"id\": \"audit_1763670157445_yp1b2bi2g\", \"level\": \"info\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:37.445Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": undefined, \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"user2\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.9, \"detectionTimestamp\": \"2025-11-20T20:22:37.448Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"res2\", \"sessionId\": undefined, \"stage\": \"high_risk_detection\", \"userId\": \"user2\"}, \"id\": \"audit_1763670157449_oxaqntgik\", \"level\": \"info\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:37.449Z\"}]\n    at Object.toHaveLength (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/high-risk-audit-trail.test.js:261:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"High-Risk Audit Trail Integration Concurrent High-Risk Detections should handle multiple high-risk cases in sequence","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should handle multiple high-risk cases in sequence"}],"endTime":1763670157463,"message":"  ● High-Risk Audit Trail Integration › PII Redaction in Audit Trails › should redact PII in high-risk case metadata\n\n    expect(received).toHaveLength(expected)\n\n    Expected length: 1\n    Received length: 3\n    Received array:  [{\"context\": {\"logger\": \"HighRiskLogger\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.9, \"detectionTimestamp\": \"2025-11-20T20:22:28.528Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670148529_amsa8jtk0\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:28.529Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": \"session-789\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:25.540Z\", \"featureVector\": {\"indicators\": [\"malicious\", \"suspicious\"]}, \"mitigationActions\": [\"block\", \"alert\"], \"riskCategory\": \"high\", \"threatPatternId\": \"pattern-001\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"sessionId\": \"session-789\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670145542_ctlhvrifj\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:25.542Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": undefined, \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"[EMAIL_REDACTED]\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.95, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:34.448Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"sessionId\": undefined, \"stage\": \"high_risk_detection\", \"userId\": \"user@example.com\"}, \"id\": \"audit_1763670154449_s0pts9w3y\", \"level\": \"info\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:34.449Z\"}]\n\n      210 |\n      211 |       const highRiskEntries = auditLogger.getAuditEntries({ operation: 'high_risk_case' });\n    > 212 |       expect(highRiskEntries).toHaveLength(1);\n          |                               ^\n      213 |\n      214 |       const entry = highRiskEntries[0];\n      215 |       expect(entry.context.userId).toBe('[EMAIL_REDACTED]');\n\n      at Object.toHaveLength (src/tests/integration/high-risk-audit-trail.test.js:212:31)\n\n  ● High-Risk Audit Trail Integration › PII Redaction in Audit Trails › should redact PII in unknown-risk case metadata\n\n    expect(received).toHaveLength(expected)\n\n    Expected length: 1\n    Received length: 3\n    Received array:  [{\"context\": {\"logger\": \"UnknownRiskLogger\", \"severity\": \"info\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.1, \"detectionTimestamp\": \"2025-11-20T20:22:32.955Z\", \"featureVector\": {\"riskIndicators\": [\"unclear_threat\"]}, \"mitigationActions\": [\"hitl_required\"], \"riskCategory\": \"unknown\", \"threatPatternId\": \"unknown_pattern\", \"trainingLabels\": {\"supervised\": \"unknown_risk\"}}, \"resourceId\": \"resource-789\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"id\": \"audit_1763670152956_pqhsiatx7\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"unknown_risk_case\", \"timestamp\": \"2025-11-20T20:22:32.956Z\"}, {\"context\": {\"logger\": \"UnknownRiskLogger\", \"sessionId\": \"session-101\", \"severity\": \"info\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.8, \"confidenceScore\": 0.2, \"detectionTimestamp\": \"2025-11-20T20:22:30.018Z\", \"featureVector\": {\"indicators\": [\"unclear\"]}, \"mitigationActions\": [\"review\"], \"riskCategory\": \"unknown\", \"threatPatternId\": \"unknown-001\", \"trainingLabels\": {\"supervised\": \"unknown_risk\"}}, \"resourceId\": \"resource-789\", \"sessionId\": \"session-101\", \"stage\": \"unknown_risk_detection\", \"userId\": \"test-user-456\"}, \"id\": \"audit_1763670150019_ixhbdhv39\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"unknown_risk_case\", \"timestamp\": \"2025-11-20T20:22:30.019Z\"}, {\"context\": {\"logger\": \"UnknownRiskLogger\", \"sessionId\": undefined, \"severity\": \"info\", \"stage\": \"unknown_risk_detection\", \"userId\": \"[EMAIL_REDACTED]\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.1, \"detectionTimestamp\": \"2025-11-20T20:22:35.942Z\", \"featureVector\": {\"riskIndicators\": [\"unclear_threat\"]}, \"mitigationActions\": [\"hitl_required\"], \"riskCategory\": \"unknown\", \"threatPatternId\": \"unknown_pattern\", \"trainingLabels\": {\"supervised\": \"unknown_risk\"}}, \"resourceId\": \"resource-789\", \"sessionId\": undefined, \"stage\": \"unknown_risk_detection\", \"userId\": \"user@example.com\"}, \"id\": \"audit_1763670155942_tqqncvieg\", \"level\": \"info\", \"operation\": \"unknown_risk_case\", \"timestamp\": \"2025-11-20T20:22:35.942Z\"}]\n\n      229 |\n      230 |       const unknownRiskEntries = auditLogger.getAuditEntries({ operation: 'unknown_risk_case' });\n    > 231 |       expect(unknownRiskEntries).toHaveLength(1);\n          |                                  ^\n      232 |\n      233 |       const entry = unknownRiskEntries[0];\n      234 |       expect(entry.context.userId).toBe('[EMAIL_REDACTED]');\n\n      at Object.toHaveLength (src/tests/integration/high-risk-audit-trail.test.js:231:34)\n\n  ● High-Risk Audit Trail Integration › Concurrent High-Risk Detections › should handle multiple high-risk cases in sequence\n\n    expect(received).toHaveLength(expected)\n\n    Expected length: 2\n    Received length: 4\n    Received array:  [{\"context\": {\"logger\": \"HighRiskLogger\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.9, \"detectionTimestamp\": \"2025-11-20T20:22:28.528Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670148529_amsa8jtk0\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:28.529Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": \"session-789\", \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:25.540Z\", \"featureVector\": {\"indicators\": [\"malicious\", \"suspicious\"]}, \"mitigationActions\": [\"block\", \"alert\"], \"riskCategory\": \"high\", \"threatPatternId\": \"pattern-001\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"resource-456\", \"sessionId\": \"session-789\", \"stage\": \"high_risk_detection\", \"userId\": \"test-user-123\"}, \"id\": \"audit_1763670145542_ctlhvrifj\", \"level\": \"info\", \"message\": \"Data Integrity Operation\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:25.542Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": undefined, \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"user1\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.95, \"confidenceScore\": 0.95, \"detectionTimestamp\": \"2025-11-20T20:22:37.444Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"res1\", \"sessionId\": undefined, \"stage\": \"high_risk_detection\", \"userId\": \"user1\"}, \"id\": \"audit_1763670157445_yp1b2bi2g\", \"level\": \"info\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:37.445Z\"}, {\"context\": {\"logger\": \"HighRiskLogger\", \"sessionId\": undefined, \"severity\": \"warning\", \"stage\": \"high_risk_detection\", \"userId\": \"user2\"}, \"details\": {\"mlFields\": {\"anomalyScore\": 0.9, \"confidenceScore\": 0.9, \"detectionTimestamp\": \"2025-11-20T20:22:37.448Z\", \"featureVector\": {\"riskIndicators\": []}, \"mitigationActions\": [\"sanitization_applied\"], \"riskCategory\": \"high\", \"threatPatternId\": \"unknown\", \"trainingLabels\": {\"supervised\": \"high_risk\"}}, \"resourceId\": \"res2\", \"sessionId\": undefined, \"stage\": \"high_risk_detection\", \"userId\": \"user2\"}, \"id\": \"audit_1763670157449_oxaqntgik\", \"level\": \"info\", \"operation\": \"high_risk_case\", \"timestamp\": \"2025-11-20T20:22:37.449Z\"}]\n\n      259 |\n      260 |       const highRiskEntries = auditLogger.getAuditEntries({ operation: 'high_risk_case' });\n    > 261 |       expect(highRiskEntries).toHaveLength(2);\n          |                               ^\n      262 |\n      263 |       // Verify each entry has correct data\n      264 |       expect(highRiskEntries[0].details.userId).toBe('user1');\n\n      at Object.toHaveLength (src/tests/integration/high-risk-audit-trail.test.js:261:31)\n","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/high-risk-audit-trail.test.js","startTime":1763670143826,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Document Upload Endpoint (/api/documents/upload)"],"duration":118,"failureDetails":[{"matcherResult":{"actual":200,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:156:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Document Upload Endpoint (/api/documents/upload) should reject requests without trust token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject requests without trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Document Upload Endpoint (/api/documents/upload)"],"duration":52,"failureDetails":[{"matcherResult":{"actual":200,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:176:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Document Upload Endpoint (/api/documents/upload) should reject requests with invalid trust token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject requests with invalid trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Document Upload Endpoint (/api/documents/upload)"],"duration":52,"failureDetails":[{"matcherResult":{"actual":200,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:193:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Document Upload Endpoint (/api/documents/upload) should reject requests with expired trust token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject requests with expired trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Document Upload Endpoint (/api/documents/upload)"],"duration":51,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Document Upload Endpoint (/api/documents/upload) should accept requests with valid trust token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should accept requests with valid trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","PDF Generation Endpoint (/api/documents/generate-pdf)"],"duration":83,"failureDetails":[{"matcherResult":{"actual":200,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:223:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware PDF Generation Endpoint (/api/documents/generate-pdf) should reject requests without trust token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject requests without trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","PDF Generation Endpoint (/api/documents/generate-pdf)"],"duration":25,"failureDetails":[{"matcherResult":{"actual":200,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:236:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware PDF Generation Endpoint (/api/documents/generate-pdf) should reject requests with invalid trust token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject requests with invalid trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","PDF Generation Endpoint (/api/documents/generate-pdf)"],"duration":21,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware PDF Generation Endpoint (/api/documents/generate-pdf) should accept requests with valid trust token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should accept requests with valid trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Backward Compatibility - Non-Protected Endpoints"],"duration":8,"failureDetails":[{"matcherResult":{"actual":404,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 404","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 404\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:259:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Backward Compatibility - Non-Protected Endpoints should allow access to /api/sanitize without trust token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should allow access to /api/sanitize without trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Backward Compatibility - Non-Protected Endpoints"],"duration":35,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Backward Compatibility - Non-Protected Endpoints should allow access to /api/webhook/n8n without trust token","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should allow access to /api/webhook/n8n without trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Backward Compatibility - Non-Protected Endpoints"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Backward Compatibility - Non-Protected Endpoints should allow access to /api/trust-tokens/validate without trust token","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should allow access to /api/trust-tokens/validate without trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Performance Tests"],"duration":1948,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeLessThan(expected)\n\nExpected: < 2\nReceived:   19.435504990000002","pass":false}}],"failureMessages":["Error: expect(received).toBeLessThan(expected)\n\nExpected: < 2\nReceived:   19.435504990000002\n    at Object.toBeLessThan (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:306:27)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Performance Tests middleware overhead should be less than 2ms","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"middleware overhead should be less than 2ms"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Security Tests - Bypass Prevention"],"duration":48,"failureDetails":[{"matcherResult":{"actual":200,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 200\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:328:33)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Security Tests - Bypass Prevention should reject malformed JSON in trust token header","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject malformed JSON in trust token header"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Security Tests - Bypass Prevention"],"duration":15,"failureDetails":[{"matcherResult":{"actual":429,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:349:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Security Tests - Bypass Prevention should reject tokens with tampered signature","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject tokens with tampered signature"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Security Tests - Bypass Prevention"],"duration":13,"failureDetails":[{"matcherResult":{"actual":429,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:373:33)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Security Tests - Bypass Prevention should reject tokens with missing required fields","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject tokens with missing required fields"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Security Tests - Bypass Prevention"],"duration":42,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Security Tests - Bypass Prevention should allow access to /api/webhook/n8n without trust token","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should allow access to /api/webhook/n8n without trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Security Tests - Bypass Prevention"],"duration":15,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Security Tests - Bypass Prevention should allow access to /api/trust-tokens/validate without trust token","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should allow access to /api/trust-tokens/validate without trust token"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Performance Tests"],"duration":1974,"failureDetails":[{"matcherResult":{"message":"expect(received).toBeLessThan(expected)\n\nExpected: < 2\nReceived:   19.718821380000012","pass":false}}],"failureMessages":["Error: expect(received).toBeLessThan(expected)\n\nExpected: < 2\nReceived:   19.718821380000012\n    at Object.toBeLessThan (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:421:27)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Performance Tests middleware overhead should be less than 2ms","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"middleware overhead should be less than 2ms"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Security Tests - Bypass Prevention"],"duration":15,"failureDetails":[{"matcherResult":{"actual":429,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:443:33)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Security Tests - Bypass Prevention should reject malformed JSON in trust token header","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject malformed JSON in trust token header"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Security Tests - Bypass Prevention"],"duration":16,"failureDetails":[{"matcherResult":{"actual":429,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:464:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Security Tests - Bypass Prevention should reject tokens with tampered signature","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject tokens with tampered signature"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Security Tests - Bypass Prevention"],"duration":12,"failureDetails":[{"matcherResult":{"actual":429,"expected":403,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 403\nReceived: 429\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:488:33)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Security Tests - Bypass Prevention should reject tokens with missing required fields","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject tokens with missing required fields"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Security Tests - Bypass Prevention"],"duration":964,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Security Tests - Bypass Prevention /api/sanitize/json should respond in less than 100ms average","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"/api/sanitize/json should respond in less than 100ms average"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","POST /api/admin/override/activate"],"duration":22,"failureDetails":[{"matcherResult":{"actual":401,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:539:33)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests POST /api/admin/override/activate should activate admin override with valid credentials","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should activate admin override with valid credentials"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","POST /api/admin/override/activate"],"duration":26,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests POST /api/admin/override/activate should reject activation without admin auth","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should reject activation without admin auth"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","POST /api/admin/override/activate"],"duration":14,"failureDetails":[{"matcherResult":{"actual":"\"justification\" length must be at least 10 characters long","expected":"Justification required","message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: \"Justification required\"\nReceived: \"\\\"justification\\\" length must be at least 10 characters long\"","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: \"Justification required\"\nReceived: \"\\\"justification\\\" length must be at least 10 characters long\"\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:568:37)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests POST /api/admin/override/activate should reject activation with invalid justification","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should reject activation with invalid justification"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","POST /api/admin/override/activate"],"duration":18,"failureDetails":[{"matcherResult":{"actual":401,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:580:33)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests POST /api/admin/override/activate should use default duration when not specified","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should use default duration when not specified"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","DELETE /api/admin/override/:overrideId"],"duration":32,"failureDetails":[{"matcherResult":{"actual":401,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:607:33)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests DELETE /api/admin/override/:overrideId should deactivate active override","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should deactivate active override"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","DELETE /api/admin/override/:overrideId"],"duration":30,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests DELETE /api/admin/override/:overrideId should reject deactivation without auth","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should reject deactivation without auth"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","GET /api/admin/override/status"],"duration":13,"failureDetails":[{"matcherResult":{"actual":401,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 401\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:627:33)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests GET /api/admin/override/status should return override status","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should return override status"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","GET /api/admin/override/status"],"duration":14,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests GET /api/admin/override/status should reject status request without auth","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should reject status request without auth"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","Override Integration with Access Control"],"duration":61,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests Override Integration with Access Control should allow access to protected endpoint when override is active","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should allow access to protected endpoint when override is active"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","Security Tests - Override Abuse Prevention"],"duration":10,"failureDetails":[{"matcherResult":{"actual":"\"duration\" must be greater than or equal to 60000","expected":"Invalid duration","message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: \"Invalid duration\"\nReceived: \"\\\"duration\\\" must be greater than or equal to 60000\"","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: \"Invalid duration\"\nReceived: \"\\\"duration\\\" must be greater than or equal to 60000\"\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:695:37)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests Security Tests - Override Abuse Prevention should reject override activation with invalid duration","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"failed","title":"should reject override activation with invalid duration"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Admin Override API Tests","Security Tests - Override Abuse Prevention"],"duration":33,"failureDetails":[{"matcherResult":{"actual":401,"expected":429,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 429\nReceived: 401","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 429\nReceived: 401\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:717:33)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Admin Override API Tests Security Tests - Override Abuse Prevention should limit concurrent overrides","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should limit concurrent overrides"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Agent Sync Mode Tests"],"duration":28,"failureDetails":[{"matcherResult":{"actual":202,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 202","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 202\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:734:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Agent Sync Mode Tests should detect agent request via X-Agent-Key header","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should detect agent request via X-Agent-Key header"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Agent Sync Mode Tests"],"duration":20,"failureDetails":[{"matcherResult":{"actual":202,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 202","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 202\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:750:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Agent Sync Mode Tests should enforce sync mode for agent requests overriding async preference","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should enforce sync mode for agent requests overriding async preference"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Agent Sync Mode Tests"],"duration":1485,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Agent Sync Mode Tests should support explicit sync=true parameter for non-agent requests","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should support explicit sync=true parameter for non-agent requests"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Agent Sync Mode Tests"],"duration":149,"failureDetails":[{"matcherResult":{"actual":429,"expected":200,"message":"expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 429","name":"toBe","pass":false}}],"failureMessages":["Error: expect(received).toBe(expected) // Object.is equality\n\nExpected: 200\nReceived: 429\n    at Object.toBe (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js:781:31)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)"],"fullName":"API Integration Tests - Access Validation Middleware Agent Sync Mode Tests should process large PDF synchronously for agent requests","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should process large PDF synchronously for agent requests"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","Agent Sync Mode Tests"],"duration":159,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware Agent Sync Mode Tests should maintain <100ms response time for agent sanitization","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should maintain <100ms response time for agent sanitization"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","JSON Transformation"],"duration":18,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware JSON Transformation should apply key normalization to camelCase","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should apply key normalization to camelCase"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","JSON Transformation"],"duration":18,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware JSON Transformation should apply key normalization to snake_case","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should apply key normalization to snake_case"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","JSON Transformation"],"duration":18,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware JSON Transformation should remove specified fields","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should remove specified fields"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","JSON Transformation"],"duration":18,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware JSON Transformation should apply both normalization and field removal","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should apply both normalization and field removal"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","JSON Transformation"],"duration":17,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware JSON Transformation should work with async processing","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should work with async processing"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","JSON Transformation"],"duration":18,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware JSON Transformation should skip transformation for invalid JSON","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should skip transformation for invalid JSON"},{"ancestorTitles":["API Integration Tests - Access Validation Middleware","JSON Transformation"],"duration":17,"failureDetails":[],"failureMessages":[],"fullName":"API Integration Tests - Access Validation Middleware JSON Transformation should maintain backward compatibility when transform is false","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should maintain backward compatibility when transform is false"}],"endTime":1763670169458,"message":"  ● API Integration Tests - Access Validation Middleware › Document Upload Endpoint (/api/documents/upload) › should reject requests without trust token\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 200\n\n      154 |         .set('Content-Type', 'multipart/form-data');\n      155 |\n    > 156 |       expect(response.status).toBe(403);\n          |                               ^\n      157 |       expect(response.body.error).toBe('Trust token required');\n      158 |       expect(response.body.message).toContain(\n      159 |         'Trust token is required for AI agent document access',\n\n      at Object.toBe (src/tests/integration/api.test.js:156:31)\n\n  ● API Integration Tests - Access Validation Middleware › Document Upload Endpoint (/api/documents/upload) › should reject requests with invalid trust token\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 200\n\n      174 |         .set('Content-Type', 'multipart/form-data');\n      175 |\n    > 176 |       expect(response.status).toBe(403);\n          |                               ^\n      177 |       expect(response.body.error).toBe('Invalid trust token');\n      178 |     });\n      179 |\n\n      at Object.toBe (src/tests/integration/api.test.js:176:31)\n\n  ● API Integration Tests - Access Validation Middleware › Document Upload Endpoint (/api/documents/upload) › should reject requests with expired trust token\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 200\n\n      191 |         .set('Content-Type', 'multipart/form-data');\n      192 |\n    > 193 |       expect(response.status).toBe(403);\n          |                               ^\n      194 |       expect(response.body.error).toBe('Invalid trust token');\n      195 |       expect(response.body.message).toContain('expired');\n      196 |     });\n\n      at Object.toBe (src/tests/integration/api.test.js:193:31)\n\n  ● API Integration Tests - Access Validation Middleware › PDF Generation Endpoint (/api/documents/generate-pdf) › should reject requests without trust token\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 200\n\n      221 |       });\n      222 |\n    > 223 |       expect(response.status).toBe(403);\n          |                               ^\n      224 |       expect(response.body.error).toBe('Trust token required');\n      225 |     });\n      226 |\n\n      at Object.toBe (src/tests/integration/api.test.js:223:31)\n\n  ● API Integration Tests - Access Validation Middleware › PDF Generation Endpoint (/api/documents/generate-pdf) › should reject requests with invalid trust token\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 200\n\n      234 |         });\n      235 |\n    > 236 |       expect(response.status).toBe(403);\n          |                               ^\n      237 |       expect(response.body.error).toBe('Invalid trust token');\n      238 |     });\n      239 |\n\n      at Object.toBe (src/tests/integration/api.test.js:236:31)\n\n  ● API Integration Tests - Access Validation Middleware › Backward Compatibility - Non-Protected Endpoints › should allow access to /api/sanitize without trust token\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 404\n\n      257 |\n      258 |       expect(response.status).not.toBe(403);\n    > 259 |       expect(response.status).toBe(200);\n          |                               ^\n      260 |     });\n      261 |\n      262 |     test('should allow access to /api/webhook/n8n without trust token', async () => {\n\n      at Object.toBe (src/tests/integration/api.test.js:259:31)\n\n  ● API Integration Tests - Access Validation Middleware › Performance Tests › middleware overhead should be less than 2ms\n\n    expect(received).toBeLessThan(expected)\n\n    Expected: < 2\n    Received:   19.435504990000002\n\n      304 |\n      305 |       // Allow some buffer for test environment variability\n    > 306 |       expect(averageTime).toBeLessThan(2);\n          |                           ^\n      307 |       expect(maxTime).toBeLessThan(5); // Max should also be reasonable\n      308 |     });\n      309 |   });\n\n      at Object.toBeLessThan (src/tests/integration/api.test.js:306:27)\n\n  ● API Integration Tests - Access Validation Middleware › Security Tests - Bypass Prevention › should reject malformed JSON in trust token header\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 200\n\n      326 |           .set('Content-Type', 'multipart/form-data');\n      327 |\n    > 328 |         expect(response.status).toBe(403);\n          |                                 ^\n      329 |         expect(response.body.error).toBe('Invalid trust token format');\n      330 |       }\n      331 |     });\n\n      at Object.toBe (src/tests/integration/api.test.js:328:33)\n\n  ● API Integration Tests - Access Validation Middleware › Security Tests - Bypass Prevention › should reject tokens with tampered signature\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 429\n\n      347 |         .set('Content-Type', 'multipart/form-data');\n      348 |\n    > 349 |       expect(response.status).toBe(403);\n          |                               ^\n      350 |       expect(response.body.error).toBe('Invalid trust token');\n      351 |     });\n      352 |\n\n      at Object.toBe (src/tests/integration/api.test.js:349:31)\n\n  ● API Integration Tests - Access Validation Middleware › Security Tests - Bypass Prevention › should reject tokens with missing required fields\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 429\n\n      371 |           .set('Content-Type', 'multipart/form-data');\n      372 |\n    > 373 |         expect(response.status).toBe(403);\n          |                                 ^\n      374 |         expect(response.body.error).toBe('Invalid trust token');\n      375 |       }\n      376 |     });\n\n      at Object.toBe (src/tests/integration/api.test.js:373:33)\n\n  ● API Integration Tests - Access Validation Middleware › Performance Tests › middleware overhead should be less than 2ms\n\n    expect(received).toBeLessThan(expected)\n\n    Expected: < 2\n    Received:   19.718821380000012\n\n      419 |\n      420 |       // Allow some buffer for test environment variability\n    > 421 |       expect(averageTime).toBeLessThan(2);\n          |                           ^\n      422 |       expect(maxTime).toBeLessThan(5); // Max should also be reasonable\n      423 |     });\n      424 |   });\n\n      at Object.toBeLessThan (src/tests/integration/api.test.js:421:27)\n\n  ● API Integration Tests - Access Validation Middleware › Security Tests - Bypass Prevention › should reject malformed JSON in trust token header\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 429\n\n      441 |           .set('Content-Type', 'multipart/form-data');\n      442 |\n    > 443 |         expect(response.status).toBe(403);\n          |                                 ^\n      444 |         expect(response.body.error).toBe('Invalid trust token format');\n      445 |       }\n      446 |     });\n\n      at Object.toBe (src/tests/integration/api.test.js:443:33)\n\n  ● API Integration Tests - Access Validation Middleware › Security Tests - Bypass Prevention › should reject tokens with tampered signature\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 429\n\n      462 |         .set('Content-Type', 'multipart/form-data');\n      463 |\n    > 464 |       expect(response.status).toBe(403);\n          |                               ^\n      465 |       expect(response.body.error).toBe('Invalid trust token');\n      466 |     });\n      467 |\n\n      at Object.toBe (src/tests/integration/api.test.js:464:31)\n\n  ● API Integration Tests - Access Validation Middleware › Security Tests - Bypass Prevention › should reject tokens with missing required fields\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 403\n    Received: 429\n\n      486 |           .set('Content-Type', 'multipart/form-data');\n      487 |\n    > 488 |         expect(response.status).toBe(403);\n          |                                 ^\n      489 |         expect(response.body.error).toBe('Invalid trust token');\n      490 |       }\n      491 |     });\n\n      at Object.toBe (src/tests/integration/api.test.js:488:33)\n\n  ● API Integration Tests - Access Validation Middleware › Admin Override API Tests › POST /api/admin/override/activate › should activate admin override with valid credentials\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 401\n\n      537 |           });\n      538 |\n    > 539 |         expect(response.status).toBe(200);\n          |                                 ^\n      540 |         expect(response.body.message).toBe('Admin override activated successfully');\n      541 |         expect(response.body).toHaveProperty('overrideId');\n      542 |         expect(response.body.adminId).toBe(adminIdHeader);\n\n      at Object.toBe (src/tests/integration/api.test.js:539:33)\n\n  ● API Integration Tests - Access Validation Middleware › Admin Override API Tests › POST /api/admin/override/activate › should reject activation with invalid justification\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"Justification required\"\n    Received: \"\\\"justification\\\" length must be at least 10 characters long\"\n\n      566 |\n      567 |         expect(response.status).toBe(400);\n    > 568 |         expect(response.body.error).toBe('Justification required');\n          |                                     ^\n      569 |       });\n      570 |\n      571 |       test('should use default duration when not specified', async () => {\n\n      at Object.toBe (src/tests/integration/api.test.js:568:37)\n\n  ● API Integration Tests - Access Validation Middleware › Admin Override API Tests › POST /api/admin/override/activate › should use default duration when not specified\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 401\n\n      578 |           });\n      579 |\n    > 580 |         expect(response.status).toBe(200);\n          |                                 ^\n      581 |         expect(response.body.duration).toBe(900_000); // 15 minutes default\n      582 |       });\n      583 |     });\n\n      at Object.toBe (src/tests/integration/api.test.js:580:33)\n\n  ● API Integration Tests - Access Validation Middleware › Admin Override API Tests › DELETE /api/admin/override/:overrideId › should deactivate active override\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 401\n\n      605 |           .set('x-admin-id', adminIdHeader);\n      606 |\n    > 607 |         expect(response.status).toBe(200);\n          |                                 ^\n      608 |         expect(response.body.message).toBe('Admin override deactivated successfully');\n      609 |         expect(response.body.overrideId).toBe(overrideId);\n      610 |       });\n\n      at Object.toBe (src/tests/integration/api.test.js:607:33)\n\n  ● API Integration Tests - Access Validation Middleware › Admin Override API Tests › GET /api/admin/override/status › should return override status\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 401\n\n      625 |           .set('x-admin-id', adminIdHeader);\n      626 |\n    > 627 |         expect(response.status).toBe(200);\n          |                                 ^\n      628 |         expect(response.body).toHaveProperty('activeOverrides');\n      629 |         expect(response.body).toHaveProperty('maxConcurrent');\n      630 |         expect(response.body).toHaveProperty('overrides');\n\n      at Object.toBe (src/tests/integration/api.test.js:627:33)\n\n  ● API Integration Tests - Access Validation Middleware › Admin Override API Tests › Security Tests - Override Abuse Prevention › should reject override activation with invalid duration\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: \"Invalid duration\"\n    Received: \"\\\"duration\\\" must be greater than or equal to 60000\"\n\n      693 |\n      694 |         expect(response.status).toBe(400);\n    > 695 |         expect(response.body.error).toBe('Invalid duration');\n          |                                     ^\n      696 |       });\n      697 |\n      698 |       test('should limit concurrent overrides', async () => {\n\n      at Object.toBe (src/tests/integration/api.test.js:695:37)\n\n  ● API Integration Tests - Access Validation Middleware › Admin Override API Tests › Security Tests - Override Abuse Prevention › should limit concurrent overrides\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 429\n    Received: 401\n\n      715 |           });\n      716 |\n    > 717 |         expect(response.status).toBe(429);\n          |                                 ^\n      718 |         expect(response.body.error).toBe('Concurrent override limit exceeded');\n      719 |       });\n      720 |     });\n\n      at Object.toBe (src/tests/integration/api.test.js:717:33)\n\n  ● API Integration Tests - Access Validation Middleware › Agent Sync Mode Tests › should detect agent request via X-Agent-Key header\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 202\n\n      732 |         });\n      733 |\n    > 734 |       expect(response.status).toBe(200);\n          |                               ^\n      735 |       expect(response.body.sanitizedContent).toBeDefined();\n      736 |       expect(response.body.trustToken).toBeDefined();\n      737 |       expect(response.headers['x-agent-request']).toBe('true');\n\n      at Object.toBe (src/tests/integration/api.test.js:734:31)\n\n  ● API Integration Tests - Access Validation Middleware › Agent Sync Mode Tests › should enforce sync mode for agent requests overriding async preference\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 202\n\n      748 |         });\n      749 |\n    > 750 |       expect(response.status).toBe(200);\n          |                               ^\n      751 |       expect(response.body.sanitizedContent).toBeDefined();\n      752 |       // Should not have async processing headers\n      753 |       expect(response.headers['x-api-version']).toBeUndefined();\n\n      at Object.toBe (src/tests/integration/api.test.js:750:31)\n\n  ● API Integration Tests - Access Validation Middleware › Agent Sync Mode Tests › should process large PDF synchronously for agent requests\n\n    expect(received).toBe(expected) // Object.is equality\n\n    Expected: 200\n    Received: 429\n\n      779 |         .set('Content-Type', 'multipart/form-data');\n      780 |\n    > 781 |       expect(response.status).toBe(200);\n          |                               ^\n      782 |       expect(response.body.message).toContain('processed successfully');\n      783 |       expect(response.body.sanitizedContent).toBeDefined();\n      784 |       expect(response.body.trustToken).toBeDefined();\n\n      at Object.toBe (src/tests/integration/api.test.js:781:31)\n","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/api.test.js","startTime":1763670157469,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["API Contract Validation Integration Tests","GET /health"],"duration":14,"failureDetails":[],"failureMessages":[],"fullName":"API Contract Validation Integration Tests GET /health should return healthy status with valid response","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should return healthy status with valid response"},{"ancestorTitles":["API Contract Validation Integration Tests","GET /health"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"API Contract Validation Integration Tests GET /health should handle invalid response gracefully (validation logs error but responds)","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle invalid response gracefully (validation logs error but responds)"},{"ancestorTitles":["API Contract Validation Integration Tests","POST /api/webhook/n8n"],"duration":33,"failureDetails":[],"failureMessages":[],"fullName":"API Contract Validation Integration Tests POST /api/webhook/n8n should process valid webhook request","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should process valid webhook request"},{"ancestorTitles":["API Contract Validation Integration Tests","POST /api/webhook/n8n"],"duration":11,"failureDetails":[],"failureMessages":[],"fullName":"API Contract Validation Integration Tests POST /api/webhook/n8n should handle invalid webhook request gracefully","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle invalid webhook request gracefully"},{"ancestorTitles":["API Contract Validation Integration Tests","POST /api/documents/upload"],"duration":18,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 403 \"Forbidden\"\n    at Object.expect (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/validation-endpoints.test.js:56:10)\n    at Promise.then.completed (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-runner/build/runTest.js:444:34)\n----\n    at Test._assertStatus (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:252:14)\n    at /home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:633:28)\n    at Server.emit (node:events:519:28)\n    at emitCloseNT (node:net:2419:8)\n    at processTicksAndRejections (node:internal/process/task_queues:89:21)"],"fullName":"API Contract Validation Integration Tests POST /api/documents/upload should upload and process valid PDF","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should upload and process valid PDF"},{"ancestorTitles":["API Contract Validation Integration Tests","POST /api/documents/upload"],"duration":16,"failureDetails":[{}],"failureMessages":["Error: expected 400 \"Bad Request\", got 403 \"Forbidden\"\n    at Object.expect (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/validation-endpoints.test.js:68:10)\n    at Promise.then.completed (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-runner/build/runTest.js:444:34)\n----\n    at Test._assertStatus (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:252:14)\n    at /home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:633:28)\n    at Server.emit (node:events:519:28)\n    at emitCloseNT (node:net:2419:8)\n    at processTicksAndRejections (node:internal/process/task_queues:89:21)"],"fullName":"API Contract Validation Integration Tests POST /api/documents/upload should reject invalid file type","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should reject invalid file type"},{"ancestorTitles":["API Contract Validation Integration Tests","POST /api/trust-tokens/validate"],"duration":8,"failureDetails":[{}],"failureMessages":["Error: expected 200 \"OK\", got 400 \"Bad Request\"\n    at Object.expect (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/validation-endpoints.test.js:90:10)\n    at Promise.then.completed (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/utils.js:298:28)\n    at new Promise (<anonymous>)\n    at callAsyncCircusFn (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/utils.js:231:10)\n    at _callCircusTest (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:316:40)\n    at processTicksAndRejections (node:internal/process/task_queues:105:5)\n    at _runTest (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:252:3)\n    at _runTestsForDescribeBlock (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:126:9)\n    at _runTestsForDescribeBlock (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:121:9)\n    at _runTestsForDescribeBlock (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:121:9)\n    at run (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/run.js:71:3)\n    at runAndTransformResultsToJestFormat (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapterInit.js:122:21)\n    at jestAdapter (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-circus/build/legacy-code-todo-rewrite/jestAdapter.js:79:19)\n    at runTestInternal (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-runner/build/runTest.js:367:16)\n    at runTest (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/jest-runner/build/runTest.js:444:34)\n----\n    at Test._assertStatus (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:252:14)\n    at /home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:308:13\n    at Test._assertFunction (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:285:13)\n    at Test.assert (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:164:23)\n    at Server.localAssert (/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/node_modules/supertest/lib/test.js:120:14)\n    at Object.onceWrapper (node:events:633:28)\n    at Server.emit (node:events:519:28)\n    at emitCloseNT (node:net:2419:8)\n    at processTicksAndRejections (node:internal/process/task_queues:89:21)"],"fullName":"API Contract Validation Integration Tests POST /api/trust-tokens/validate should validate valid trust token","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"failed","title":"should validate valid trust token"},{"ancestorTitles":["API Contract Validation Integration Tests","POST /api/trust-tokens/validate"],"duration":11,"failureDetails":[],"failureMessages":[],"fullName":"API Contract Validation Integration Tests POST /api/trust-tokens/validate should reject invalid trust token","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should reject invalid trust token"}],"endTime":1763670173269,"message":"  ● API Contract Validation Integration Tests › POST /api/documents/upload › should upload and process valid PDF\n\n    expected 200 \"OK\", got 403 \"Forbidden\"\n\n      54 |         .post('/api/documents/upload')\n      55 |         .attach('pdf', pdfBuffer, 'test.pdf')\n    > 56 |         .expect(200);\n         |          ^\n      57 |\n      58 |       expect(response.body).toHaveProperty('message');\n      59 |       expect(response.body).toHaveProperty('fileName', 'test.pdf');\n\n      at Object.expect (src/tests/integration/validation-endpoints.test.js:56:10)\n      ----\n      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)\n      at node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)\n\n  ● API Contract Validation Integration Tests › POST /api/documents/upload › should reject invalid file type\n\n    expected 400 \"Bad Request\", got 403 \"Forbidden\"\n\n      66 |         .post('/api/documents/upload')\n      67 |         .attach('pdf', Buffer.from('not a pdf'), 'test.txt')\n    > 68 |         .expect(400);\n         |          ^\n      69 |\n      70 |       expect(response.body).toHaveProperty('error');\n      71 |     });\n\n      at Object.expect (src/tests/integration/validation-endpoints.test.js:68:10)\n      ----\n      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)\n      at node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)\n\n  ● API Contract Validation Integration Tests › POST /api/trust-tokens/validate › should validate valid trust token\n\n    expected 200 \"OK\", got 400 \"Bad Request\"\n\n      88 |         .post('/api/trust-tokens/validate')\n      89 |         .send(validToken)\n    > 90 |         .expect(200);\n         |          ^\n      91 |\n      92 |       expect(response.body).toHaveProperty('valid', true);\n      93 |       expect(response.body).toHaveProperty('message');\n\n      at Object.expect (src/tests/integration/validation-endpoints.test.js:90:10)\n      ----\n      at Test._assertStatus (node_modules/supertest/lib/test.js:252:14)\n      at node_modules/supertest/lib/test.js:308:13\n      at Test._assertFunction (node_modules/supertest/lib/test.js:285:13)\n      at Test.assert (node_modules/supertest/lib/test.js:164:23)\n      at Server.localAssert (node_modules/supertest/lib/test.js:120:14)\n","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/validation-endpoints.test.js","startTime":1763670169461,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":["Data Integrity Validation Integration","End-to-End Data Flow"],"duration":2108,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration End-to-End Data Flow should process data through sanitization with integrity validation","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should process data through sanitization with integrity validation"},{"ancestorTitles":["Data Integrity Validation Integration","End-to-End Data Flow"],"duration":2005,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration End-to-End Data Flow should validate data integrity for processed content","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should validate data integrity for processed content"},{"ancestorTitles":["Data Integrity Validation Integration","End-to-End Data Flow"],"duration":2069,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration End-to-End Data Flow should handle validation failures gracefully","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should handle validation failures gracefully"},{"ancestorTitles":["Data Integrity Validation Integration","End-to-End Data Flow"],"duration":2054,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration End-to-End Data Flow should maintain data lineage with hash references","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should maintain data lineage with hash references"},{"ancestorTitles":["Data Integrity Validation Integration","End-to-End Data Flow"],"duration":2109,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration End-to-End Data Flow should enforce read-only access to sanitized data","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should enforce read-only access to sanitized data"},{"ancestorTitles":["Data Integrity Validation Integration","End-to-End Data Flow"],"duration":2013,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration End-to-End Data Flow should perform atomic operations","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should perform atomic operations"},{"ancestorTitles":["Data Integrity Validation Integration","End-to-End Data Flow"],"duration":2107,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration End-to-End Data Flow should route and manage errors","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should route and manage errors"},{"ancestorTitles":["Data Integrity Validation Integration","End-to-End Data Flow"],"duration":2026,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration End-to-End Data Flow should provide comprehensive statistics","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should provide comprehensive statistics"},{"ancestorTitles":["Data Integrity Validation Integration","Performance and Reliability"],"duration":2021,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration Performance and Reliability should handle large datasets","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle large datasets"},{"ancestorTitles":["Data Integrity Validation Integration","Performance and Reliability"],"duration":1992,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration Performance and Reliability should maintain data integrity under concurrent operations","invocations":1,"location":null,"numPassingAsserts":10,"retryReasons":[],"status":"passed","title":"should maintain data integrity under concurrent operations"},{"ancestorTitles":["Data Integrity Validation Integration","Security and Compliance"],"duration":2028,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration Security and Compliance should prevent unauthorized access","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should prevent unauthorized access"},{"ancestorTitles":["Data Integrity Validation Integration","Security and Compliance"],"duration":2026,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration Security and Compliance should audit all operations","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should audit all operations"},{"ancestorTitles":["Data Integrity Validation Integration","Security and Compliance"],"duration":2025,"failureDetails":[],"failureMessages":[],"fullName":"Data Integrity Validation Integration Security and Compliance should detect data tampering attempts","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should detect data tampering attempts"}],"endTime":1763670199899,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/data-validation.test.js","startTime":1763670173272,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["AdminOverrideController - Expiration Integration Tests","Multiple concurrent overrides with different expiration times"],"duration":6314,"failureDetails":[],"failureMessages":[],"fullName":"AdminOverrideController - Expiration Integration Tests Multiple concurrent overrides with different expiration times should handle multiple overrides expiring at different times","invocations":1,"location":null,"numPassingAsserts":11,"retryReasons":[],"status":"passed","title":"should handle multiple overrides expiring at different times"},{"ancestorTitles":["AdminOverrideController - Expiration Integration Tests","Expiration during active override operations"],"duration":1106,"failureDetails":[],"failureMessages":[],"fullName":"AdminOverrideController - Expiration Integration Tests Expiration during active override operations should handle expiration while checking status","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle expiration while checking status"},{"ancestorTitles":["AdminOverrideController - Expiration Integration Tests","Expiration during active override operations"],"duration":1106,"failureDetails":[],"failureMessages":[],"fullName":"AdminOverrideController - Expiration Integration Tests Expiration during active override operations should handle expiration while deactivating","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle expiration while deactivating"},{"ancestorTitles":["AdminOverrideController - Expiration Integration Tests","Edge cases"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"AdminOverrideController - Expiration Integration Tests Edge cases should handle minimum duration override","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle minimum duration override"},{"ancestorTitles":["AdminOverrideController - Expiration Integration Tests","Edge cases"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"AdminOverrideController - Expiration Integration Tests Edge cases should handle maximum duration override","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle maximum duration override"},{"ancestorTitles":["AdminOverrideController - Expiration Integration Tests","Edge cases"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"AdminOverrideController - Expiration Integration Tests Edge cases should handle override that expires immediately","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle override that expires immediately"}],"endTime":1763670208517,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/admin-override-expiration.integration.test.js","startTime":1763670199909,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["End-to-End Pipeline Testing","Complete Pipeline Flow"],"duration":1403,"failureDetails":[],"failureMessages":[],"fullName":"End-to-End Pipeline Testing Complete Pipeline Flow should complete full pipeline: sanitize → collect → export","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"should complete full pipeline: sanitize → collect → export"},{"ancestorTitles":["End-to-End Pipeline Testing","Complete Pipeline Flow"],"duration":1341,"failureDetails":[],"failureMessages":[],"fullName":"End-to-End Pipeline Testing Complete Pipeline Flow should handle invalid data submission","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle invalid data submission"},{"ancestorTitles":["End-to-End Pipeline Testing","Complete Pipeline Flow"],"duration":1385,"failureDetails":[],"failureMessages":[],"fullName":"End-to-End Pipeline Testing Complete Pipeline Flow should handle unauthorized export access","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle unauthorized export access"},{"ancestorTitles":["End-to-End Pipeline Testing","Complete Pipeline Flow"],"duration":1340,"failureDetails":[],"failureMessages":[],"fullName":"End-to-End Pipeline Testing Complete Pipeline Flow should handle invalid export format","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle invalid export format"}],"endTime":1763670214128,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/end-to-end-pipeline.test.js","startTime":1763670208521,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Agent Sync Mode Integration Tests","Agent Detection and Sync Enforcement"],"duration":24,"failureDetails":[],"failureMessages":[],"fullName":"Agent Sync Mode Integration Tests Agent Detection and Sync Enforcement should detect agent request via X-Agent-Key header","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should detect agent request via X-Agent-Key header"},{"ancestorTitles":["Agent Sync Mode Integration Tests","Agent Detection and Sync Enforcement"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"Agent Sync Mode Integration Tests Agent Detection and Sync Enforcement should enforce sync mode for agent requests overriding async preference","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should enforce sync mode for agent requests overriding async preference"},{"ancestorTitles":["Agent Sync Mode Integration Tests","Agent Detection and Sync Enforcement"],"duration":17,"failureDetails":[],"failureMessages":[],"fullName":"Agent Sync Mode Integration Tests Agent Detection and Sync Enforcement should support explicit sync=true parameter for non-agent requests","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should support explicit sync=true parameter for non-agent requests"},{"ancestorTitles":["Agent Sync Mode Integration Tests","Agent Detection and Sync Enforcement"],"duration":69,"failureDetails":[],"failureMessages":[],"fullName":"Agent Sync Mode Integration Tests Agent Detection and Sync Enforcement should process small PDF synchronously for agent requests","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should process small PDF synchronously for agent requests"},{"ancestorTitles":["Agent Sync Mode Integration Tests","Agent Detection and Sync Enforcement"],"duration":167,"failureDetails":[],"failureMessages":[],"fullName":"Agent Sync Mode Integration Tests Agent Detection and Sync Enforcement should maintain <100ms response time for agent sanitization","invocations":1,"location":null,"numPassingAsserts":12,"retryReasons":[],"status":"passed","title":"should maintain <100ms response time for agent sanitization"}],"endTime":1763670218094,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/agent-sync.test.js","startTime":1763670214131,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Access Audit Logging Integration","Trust Token Validation Logging"],"duration":49,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Trust Token Validation Logging should log successful trust token validation","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should log successful trust token validation"},{"ancestorTitles":["Access Audit Logging Integration","Trust Token Validation Logging"],"duration":12,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Trust Token Validation Logging should log failed trust token validation - invalid token","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should log failed trust token validation - invalid token"},{"ancestorTitles":["Access Audit Logging Integration","Trust Token Validation Logging"],"duration":12,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Trust Token Validation Logging should log failed trust token validation - malformed token","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should log failed trust token validation - malformed token"},{"ancestorTitles":["Access Audit Logging Integration","Audit Logger Component Integration"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Audit Logger Component Integration should create audit entries with proper structure","invocations":1,"location":null,"numPassingAsserts":9,"retryReasons":[],"status":"passed","title":"should create audit entries with proper structure"},{"ancestorTitles":["Access Audit Logging Integration","Audit Logger Component Integration"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Audit Logger Component Integration should maintain audit trail integrity","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should maintain audit trail integrity"},{"ancestorTitles":["Access Audit Logging Integration","Audit Logger Component Integration"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Audit Logger Component Integration should provide audit statistics","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"should provide audit statistics"},{"ancestorTitles":["Access Audit Logging Integration","Audit Logger Component Integration"],"duration":4,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Audit Logger Component Integration should filter audit entries correctly","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should filter audit entries correctly"},{"ancestorTitles":["Access Audit Logging Integration","Performance and Security Validation"],"duration":25,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Performance and Security Validation should maintain performance with multiple log entries","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should maintain performance with multiple log entries"},{"ancestorTitles":["Access Audit Logging Integration","Performance and Security Validation"],"duration":41,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Performance and Security Validation should handle concurrent logging operations","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle concurrent logging operations"},{"ancestorTitles":["Access Audit Logging Integration","Performance and Security Validation"],"duration":5,"failureDetails":[],"failureMessages":[],"fullName":"Access Audit Logging Integration Performance and Security Validation should maintain data integrity under load","invocations":1,"location":null,"numPassingAsserts":14,"retryReasons":[],"status":"passed","title":"should maintain data integrity under load"}],"endTime":1763670221860,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/access-audit-log.test.js","startTime":1763670218096,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Conditional Sanitization Integration"],"duration":32,"failureDetails":[],"failureMessages":[],"fullName":"Conditional Sanitization Integration should sanitize LLM-bound requests via /sanitize/json","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should sanitize LLM-bound requests via /sanitize/json"},{"ancestorTitles":["Conditional Sanitization Integration"],"duration":14,"failureDetails":[],"failureMessages":[],"fullName":"Conditional Sanitization Integration should bypass sanitization for non-LLM requests via /sanitize/json","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should bypass sanitization for non-LLM requests via /sanitize/json"},{"ancestorTitles":["Conditional Sanitization Integration"],"duration":28,"failureDetails":[],"failureMessages":[],"fullName":"Conditional Sanitization Integration should sanitize LLM requests via /webhook/n8n","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should sanitize LLM requests via /webhook/n8n"},{"ancestorTitles":["Conditional Sanitization Integration"],"duration":20,"failureDetails":[],"failureMessages":[],"fullName":"Conditional Sanitization Integration should bypass sanitization for non-LLM requests via /webhook/n8n","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should bypass sanitization for non-LLM requests via /webhook/n8n"},{"ancestorTitles":["Conditional Sanitization Integration"],"duration":18,"failureDetails":[],"failureMessages":[],"fullName":"Conditional Sanitization Integration should default to sanitization for unclear requests","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should default to sanitization for unclear requests"}],"endTime":1763670225527,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/conditional-sanitization.test.js","startTime":1763670221864,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["PDF AI Workflow Integration Tests","POST /api/documents/upload with AI transformation"],"duration":33,"failureDetails":[],"failureMessages":[],"fullName":"PDF AI Workflow Integration Tests POST /api/documents/upload with AI transformation should process PDF with AI transformation and return structured JSON","invocations":1,"location":null,"numPassingAsserts":7,"retryReasons":[],"status":"passed","title":"should process PDF with AI transformation and return structured JSON"},{"ancestorTitles":["PDF AI Workflow Integration Tests","POST /api/documents/upload with AI transformation"],"duration":19,"failureDetails":[],"failureMessages":[],"fullName":"PDF AI Workflow Integration Tests POST /api/documents/upload with AI transformation should fallback to sanitization when AI fails","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"status":"passed","title":"should fallback to sanitization when AI fails"},{"ancestorTitles":["PDF AI Workflow Integration Tests","POST /api/documents/upload with AI transformation"],"duration":27,"failureDetails":[],"failureMessages":[],"fullName":"PDF AI Workflow Integration Tests POST /api/documents/upload with AI transformation should process PDF without AI transformation and return text","invocations":1,"location":null,"numPassingAsserts":6,"retryReasons":[],"status":"passed","title":"should process PDF without AI transformation and return text"}],"endTime":1763670227788,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/pdf-ai-workflow.test.js","startTime":1763670225530,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["n8n Webhook Integration"],"duration":14,"failureDetails":[],"failureMessages":[],"fullName":"n8n Webhook Integration should process n8n webhook end-to-end","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should process n8n webhook end-to-end"},{"ancestorTitles":["n8n Webhook Integration"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"n8n Webhook Integration should apply input and output sanitization","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should apply input and output sanitization"}],"endTime":1763670230042,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/n8n-webhook.test.js","startTime":1763670227790,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Async Processing Integration Tests","POST /api/sanitize/json - Async Mode"],"duration":24,"failureDetails":[],"failureMessages":[],"fullName":"Async Processing Integration Tests POST /api/sanitize/json - Async Mode should submit async sanitization job and return task ID","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should submit async sanitization job and return task ID"},{"ancestorTitles":["Async Processing Integration Tests","POST /api/sanitize/json - Async Mode"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"Async Processing Integration Tests POST /api/sanitize/json - Async Mode should handle queue submission errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle queue submission errors"},{"ancestorTitles":["Async Processing Integration Tests","POST /api/sanitize/json - Async Mode"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"Async Processing Integration Tests POST /api/sanitize/json - Async Mode should process synchronously when async is false","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should process synchronously when async is false"},{"ancestorTitles":["Async Processing Integration Tests","POST /api/documents/upload - Async Processing"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"Async Processing Integration Tests POST /api/documents/upload - Async Processing should submit PDF upload job and return task ID","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should submit PDF upload job and return task ID"},{"ancestorTitles":["Async Processing Integration Tests","POST /api/documents/upload - Async Processing"],"duration":14,"failureDetails":[],"failureMessages":[],"fullName":"Async Processing Integration Tests POST /api/documents/upload - Async Processing should handle upload job submission errors","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should handle upload job submission errors"},{"ancestorTitles":["Async Processing Integration Tests","GET /api/jobs/:taskId - Status Polling"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"Async Processing Integration Tests GET /api/jobs/:taskId - Status Polling should return job status for processing job","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should return job status for processing job"},{"ancestorTitles":["Async Processing Integration Tests","GET /api/jobs/:taskId - Status Polling"],"duration":9,"failureDetails":[],"failureMessages":[],"fullName":"Async Processing Integration Tests GET /api/jobs/:taskId - Status Polling should return result for completed job","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should return result for completed job"},{"ancestorTitles":["Async Processing Integration Tests","GET /api/jobs/:taskId - Status Polling"],"duration":8,"failureDetails":[],"failureMessages":[],"fullName":"Async Processing Integration Tests GET /api/jobs/:taskId - Status Polling should return error for failed job","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should return error for failed job"},{"ancestorTitles":["Async Processing Integration Tests","GET /api/jobs/:taskId - Status Polling"],"duration":10,"failureDetails":[],"failureMessages":[],"fullName":"Async Processing Integration Tests GET /api/jobs/:taskId - Status Polling should return 404 for non-existent job","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return 404 for non-existent job"}],"endTime":1763670230213,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/async-processing.test.js","startTime":1763670230045,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Data Export API Integration","POST /api/export/training-data"],"duration":14,"failureDetails":[],"failureMessages":[],"fullName":"Data Export API Integration POST /api/export/training-data should export JSON data successfully","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should export JSON data successfully"},{"ancestorTitles":["Data Export API Integration","POST /api/export/training-data"],"duration":11,"failureDetails":[],"failureMessages":[],"fullName":"Data Export API Integration POST /api/export/training-data should export CSV data successfully","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should export CSV data successfully"},{"ancestorTitles":["Data Export API Integration","POST /api/export/training-data"],"duration":21,"failureDetails":[],"failureMessages":[],"fullName":"Data Export API Integration POST /api/export/training-data should export Parquet data successfully","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should export Parquet data successfully"},{"ancestorTitles":["Data Export API Integration","POST /api/export/training-data"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"Data Export API Integration POST /api/export/training-data should filter data by date range","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should filter data by date range"},{"ancestorTitles":["Data Export API Integration","POST /api/export/training-data"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"Data Export API Integration POST /api/export/training-data should filter data by risk score","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should filter data by risk score"},{"ancestorTitles":["Data Export API Integration","POST /api/export/training-data"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"Data Export API Integration POST /api/export/training-data should return 400 for invalid format","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return 400 for invalid format"},{"ancestorTitles":["Data Export API Integration","POST /api/export/training-data"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"Data Export API Integration POST /api/export/training-data should return 500 when no data available","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should return 500 when no data available"}],"endTime":1763670230352,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/data-export-api.test.js","startTime":1763670230216,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Destination Tracking Integration","API endpoint classification"],"duration":9,"failureDetails":[],"failureMessages":[],"fullName":"Destination Tracking Integration API endpoint classification should classify LLM-bound request with header","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should classify LLM-bound request with header"},{"ancestorTitles":["Destination Tracking Integration","API endpoint classification"],"duration":9,"failureDetails":[],"failureMessages":[],"fullName":"Destination Tracking Integration API endpoint classification should classify non-LLM request with file path","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should classify non-LLM request with file path"},{"ancestorTitles":["Destination Tracking Integration","API endpoint classification"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"Destination Tracking Integration API endpoint classification should handle JSON content type","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should handle JSON content type"},{"ancestorTitles":["Destination Tracking Integration","API endpoint classification"],"duration":7,"failureDetails":[],"failureMessages":[],"fullName":"Destination Tracking Integration API endpoint classification should handle text content type","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should handle text content type"},{"ancestorTitles":["Destination Tracking Integration","Error handling"],"duration":6,"failureDetails":[],"failureMessages":[],"fullName":"Destination Tracking Integration Error handling should handle malformed requests gracefully","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should handle malformed requests gracefully"}],"endTime":1763670230439,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/destination-tracking.test.js","startTime":1763670230355,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["HITL Escalation Logging Integration"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"HITL Escalation Logging Integration should log complete escalation workflow from decision to intervention","invocations":1,"location":null,"numPassingAsserts":18,"retryReasons":[],"status":"passed","title":"should log complete escalation workflow from decision to intervention"},{"ancestorTitles":["HITL Escalation Logging Integration"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"HITL Escalation Logging Integration should handle multiple escalations with different outcomes","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should handle multiple escalations with different outcomes"},{"ancestorTitles":["HITL Escalation Logging Integration"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"HITL Escalation Logging Integration should maintain audit integrity with PII redaction","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should maintain audit integrity with PII redaction"}],"endTime":1763670230471,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/hitl-escalation-logging.test.js","startTime":1763670230441,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Reuse Mechanisms Integration Tests","Trust Token Generation and Validation"],"duration":2,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Trust Token Generation and Validation should generate valid trust tokens","invocations":1,"location":null,"numPassingAsserts":5,"retryReasons":[],"status":"passed","title":"should generate valid trust tokens"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Trust Token Generation and Validation"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Trust Token Generation and Validation should validate trust tokens correctly","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should validate trust tokens correctly"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Trust Token Generation and Validation"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Trust Token Generation and Validation should reject invalid trust tokens","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should reject invalid trust tokens"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Content Hash Verification"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Content Hash Verification should correctly compute content hashes","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should correctly compute content hashes"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Content Hash Verification"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Content Hash Verification should detect content modifications","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should detect content modifications"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Audit Logging Integration"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Audit Logging Integration should create audit logs for successful operations","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should create audit logs for successful operations"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Audit Logging Integration"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Audit Logging Integration should create audit logs for failed operations","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should create audit logs for failed operations"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Statistics and Metrics Tracking"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Statistics and Metrics Tracking should initialize and update reuse statistics","invocations":1,"location":null,"numPassingAsserts":4,"retryReasons":[],"status":"passed","title":"should initialize and update reuse statistics"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Statistics and Metrics Tracking"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Statistics and Metrics Tracking should calculate performance metrics","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should calculate performance metrics"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Performance Benchmarking"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Performance Benchmarking should measure high-resolution timing","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should measure high-resolution timing"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Performance Benchmarking"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Performance Benchmarking should track token validation performance","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should track token validation performance"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Security and Tamper Prevention"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Security and Tamper Prevention should prevent content hash tampering","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should prevent content hash tampering"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Security and Tamper Prevention"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Security and Tamper Prevention should detect signature tampering","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"status":"passed","title":"should detect signature tampering"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Security and Tamper Prevention"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Security and Tamper Prevention should handle expired tokens","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"should handle expired tokens"},{"ancestorTitles":["Reuse Mechanisms Integration Tests","Concurrent Access and Thread Safety"],"duration":1,"failureDetails":[],"failureMessages":[],"fullName":"Reuse Mechanisms Integration Tests Concurrent Access and Thread Safety should handle concurrent statistics updates","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"should handle concurrent statistics updates"}],"endTime":1763670230504,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/reuse-mechanisms.test.js","startTime":1763670230473,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["Async Operations Testing Guide"],"duration":3,"failureDetails":[],"failureMessages":[],"fullName":"Async Operations Testing Guide Generate test data for Postman","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"Generate test data for Postman"}],"endTime":1763670230527,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/async-operations.test.js","startTime":1763670230508,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":["CI/CD Configuration"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"CI/CD Configuration Dockerfile exists and has correct base image","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"status":"passed","title":"Dockerfile exists and has correct base image"},{"ancestorTitles":["CI/CD Configuration"],"duration":0,"failureDetails":[],"failureMessages":[],"fullName":"CI/CD Configuration GitHub Actions workflow exists","invocations":1,"location":null,"numPassingAsserts":3,"retryReasons":[],"status":"passed","title":"GitHub Actions workflow exists"}],"endTime":1763670230544,"message":"","name":"/home/braedonpop/Desktop/projects/capstone/MCP-Securtiy/src/tests/integration/ci-cd.test.js","startTime":1763670230528,"status":"passed","summary":""}],"wasInterrupted":false}
